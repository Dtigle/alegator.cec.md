@using CEC.SRV.BLL
@using CEC.SRV.Domain.Constants
@using CEC.Web.SRV.Infrastructure
@using CEC.Web.SRV.Resources

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title</title>
    <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Righteous' rel='stylesheet' type='text/css'>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jquery.cookie")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/devoops")
    @Scripts.Render("~/bundles/idleTimeout")

</head>
<body>
    <!--Start Header-->
    <header class="navbar">
        <div class="container-fluid expanded-panel">
            <div class="row">
                <div id="logo" class="col-xs-12 col-sm-2">
                    @Html.ActionLink("CEC RSA", "Index", "Home")
                </div>
                <div id="top-panel" class="col-xs-12 col-sm-10">
                    <div class="row">
                        <div class="col-xs-8 col-sm-4">
                            <a href="#" class="show-sidebar">
                                <i class="fa fa-bars"></i>
                            </a>
                        </div>
                        <div class="col-xs-4 col-sm-8 top-panel-right">
                            <span style="font-size: large; background-color: yellow; color: red">Call centru: 022-88-01-01</span>
                            <ul class="nav navbar-nav pull-right panel-menu">
                                @if (SecurityHelper.LoggedUserIsInRole(Transactions.Notification))
                                {
                                    @*@<li class="hidden-xs">
                <a href="@Url.Action("Index", "Notification")">
                    <i class="fa fa-envelope"></i>
                    @Html.Partial("_NotificationItems")
                </a>
            </li>*@
                                    <li class="hidden-xs" title="Conflicte nerezolvate" style="margin-top: 5px;">
                                        <a href="@Url.Action("Index", "Conflict")">
                                            <i class="fa fa-exclamation-triangle"></i>
                                            @Html.Partial("_ConflictItems")
                                        </a>
                                    </li>
                                }
                           
                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle account" data-toggle="dropdown">
                                        <div class="avatar">
                                            @*<img src="img/avatar.jpg" class="img-rounded" alt="avatar" />*@
                                            <i class="fa fa-user"></i>
                                        </div>
                                        <i class="fa fa-angle-down pull-right"></i>
                                        <div class="user-mini pull-right">
                                            <span class="welcome">Salut </span>
                                            <span>@ViewBag.CurrentUserName</span>
                                        </div>
                                    </a>
                                    <ul class="dropdown-menu">
                                        @* <li>
                    <a href="@Url.Action("ViewProfile","Account")">
                        <i class="fa fa-user"></i>
                        <span class="hidden-sm text">@MUI.Profile</span>
                    </a>
                </li>
                @*<li>
                    <a href="#">
                        <i class="fa fa-cog"></i>
                        <span class="hidden-sm text">@MUI.Settings</span>
                    </a>
                </li>*@
                                        <li>
                                            <a href="@Url.Action("LogOff", "Account")">
                                                <i class="fa fa-power-off"></i>
                                                <span class="hidden-sm text">@MUI.Logout</span>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!--End Header-->
    <!--Start Container-->
    <div id="main" class="container-fluid">
        <div class="row">
            <div id="sidebar-left" class="col-xs-2 col-sm-2">
                <ul class="nav main-menu">
                    @Html.Partial("_MenuItems", MenuHelper.GetMenuItems(Html))
                </ul>
            </div>
            <!--Start Content-->
	        <div id="content" class="col-xs-12 col-sm-10">
		        <div class="row">
			        <div id="breadcrumb" class="col-md-12">
				        <ol class="breadcrumb">
					        @Html.Partial("_BreadcrumbMenu", MenuHelper.GetMenuItems(Html))
				        </ol>
			        </div>
		        </div>
		        @RenderBody()
	        </div>
            <!--End Content-->
        </div>
    </div>
    <!--End Container-->
    

    @Scripts.Render("~/bundles/bootstrap-dialog")
@Scripts.Render("~/bundles/bootstrap-select") 
@Scripts.Render("~/bundles/jquery-ui")

    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/jqueryform")
    
    @Scripts.Render("~/bundles/jqgrid")
    @Scripts.Render("~/bundles/select2")
    @Scripts.Render("~/bundles/openlayers")
	@Scripts.Render("~/bundles/terminal")
    
    @Scripts.Render("~/bundles/app")
    
    <div id="dialog" class="ui-dialog" title="@MUI.Auto_Logoff_Warn_Title">
        <p>
            <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 50px 0;"></span>
            @MUI.Auto_Logoff_Warn <span id="dialog-countdown" style="font-weight:bold"></span> @MUI.Auto_Logoff_Warn_Seconds.
        </p>

        <p>@MUI.Auto_Logoff_Warn_Query</p>
    </div>

    <script type="text/javascript">
        $("#dialog").dialog({
            autoOpen: false,
            modal: true,
            width: 400,
            height: 200,
            closeOnEscape: false,
            draggable: false,
            resizable: false,
            buttons: {
                '@MUI.Auto_Logoff_Confirm_Button_Continue': function(){
                    $(this).dialog('close');
                },
                '@MUI.Auto_Logoff_Confirm_Button_Exit': function(){
                    // fire whatever the configured onTimeout callback is.
                    // using .call(this) keeps the default behavior of "this" being the warning
                    // element (the dialog in this case) inside the callback.
                    $.idleTimeout.options.onTimeout.call(this);
                }
            }
        });

    // start the idle timer plugin
        $.idleTimeout('#dialog', 'div.ui-dialog-buttonpane button:first', {
            idleAfter: @Convert.ToInt32(CEC.Web.SRV.Properties.Settings.Default.IdleTimeSpan.TotalSeconds),
            pollingInterval: @Convert.ToInt32(CEC.Web.SRV.Properties.Settings.Default.SessionPollingTimeSpan.TotalSeconds),
            keepAliveURL: '@Url.Action("KeepAlive", "Home")',
            serverResponseEquals: 'OK',
            onTimeout: function() {
                window.location = '@Url.Action("LogOff", "Account")';
            },
            onIdle: function() {
                $(this).dialog("open");
            },
            onCountdown: function(counter) {
                $("#dialog-countdown").html(counter); // update the counter
            }
        });
    </script>
</body>
</html>
